<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interactive zoon usage (for developers) • zoon R package</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Interactive zoon usage (for developers)">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">zoon</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basic-zoon-usage.html">Basic zoon usage</a>
    </li>
    <li>
      <a href="../articles/Building_a_module.html">Building modules</a>
    </li>
    <li>
      <a href="../articles/interactive_zoon_usage.html">Interactive zoon usage (for developers)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/zoonproject/zoon">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Interactive zoon usage (for developers)</h1>
                        <h4 class="author">Tim Lucas</h4>
            
            <h4 class="date">2016-11-23</h4>
          </div>

    
    
<div class="contents">
<div id="using-zoon-modules-interactively-" class="section level2">
<h2 class="hasAnchor">
<a href="#using-zoon-modules-interactively-" class="anchor"></a>Using zoon modules interactively.</h2>
<p>While the point of <code>zoon</code> is to run full workflows which are then reproducible, during the development of modules it can be useful to run individual modules in the same way you would run normal R functions.</p>
<p>It is not entirely simple to do this, so this vignette just clarifies how.</p>
<p>First, load packages. You need to explicitely load <code>dismo</code> as we are now going to use <code>dismo</code> functions outside of the <code>zoon</code> environment.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dismo)
<span class="kw">library</span>(zoon)</code></pre></div>
<p>This is the <code>workflow</code> we will run. It might be worth running it here to make sure there are no problems.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">w &lt;-<span class="st"> </span><span class="kw">workflow</span>(UKAnophelesPlumbeus, UKAir, OneHundredBackground, LogisticRegression, PrintMap)</code></pre></div>
<pre><code>## Occurrence data does not have a "crs" column, zoon will assume it is in the same projection as the covariate data</code></pre>
<pre><code>## There are fewer than 100 cells in the environmental raster.
## Using all available cells (81) instead</code></pre>
<p><img src="interactive_noninteractive-1.png" title="plot of chunk interactive_noninteractive" alt="plot of chunk interactive_noninteractive" style="display:block; margin: auto"></p>
<p>It’s worth noting that this is a simple <code>workflow</code>. Chaining modules will be fairly easy but depends on the module type. Workflows using <code>list()</code> are likely to not be easy.</p>
<p>Get the modules from the <code>zoon</code> repository and load them into the working environmen:.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">LoadModule</span>(<span class="st">'UKAnophelesPlumbeus'</span>)</code></pre></div>
<pre><code>## [1] "UKAnophelesPlumbeus"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">LoadModule</span>(<span class="st">'UKAir'</span>)</code></pre></div>
<pre><code>## [1] "UKAir"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">LoadModule</span>(<span class="st">'OneHundredBackground'</span>)</code></pre></div>
<pre><code>## [1] "OneHundredBackground"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">LoadModule</span>(<span class="st">'LogisticRegression'</span>)</code></pre></div>
<pre><code>## [1] "LogisticRegression"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">LoadModule</span>(<span class="st">'PrintMap'</span>)</code></pre></div>
<pre><code>## [1] "PrintMap"</code></pre>
<p>Run the data modules. To chain occurrence modules, just <code>rbind()</code> the resulting dataframes. To chain covariate modules, use <code><a href="http://www.rdocumentation.org/packages/raster/topics/stack">raster::stack</a></code> to combine the covariate data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">oc &lt;-<span class="st"> </span><span class="kw">UKAnophelesPlumbeus</span>()

cov &lt;-<span class="st"> </span><span class="kw">UKAir</span>()</code></pre></div>
<p>We have to run <code>ExtractAndCombData()</code>. This combines the occurrence and raster data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">ExtractAndCombData</span>(oc, cov)</code></pre></div>
<pre><code>## Occurrence data does not have a "crs" column, zoon will assume it is in the same projection as the covariate data</code></pre>
<p>Next, we run the process and model modules. To chain process models, simply run each in turn with the output of one going into the next. The simple way to run model modules is to use the module function as below. If crossvalidation is important then you need to run the modules slightly differently (see below).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">proc &lt;-<span class="st"> </span><span class="kw">OneHundredBackground</span>(data)</code></pre></div>
<pre><code>## There are fewer than 100 cells in the environmental raster.
## Using all available cells (81) instead</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod &lt;-<span class="st"> </span><span class="kw">LogisticRegression</span>(proc$df)</code></pre></div>
<p>Finally, combine some output into a list and run the output modules.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">model =</span> mod, <span class="dt">data =</span> proc$df)

out &lt;-<span class="st"> </span><span class="kw">PrintMap</span>(model, cov)</code></pre></div>
<p><img src="interactive_output-1.png" title="plot of chunk interactive_output" alt="plot of chunk interactive_output" style="display:block; margin: auto"></p>
<hr>
</div>
<div id="cross-and-external-validation" class="section level2">
<h2 class="hasAnchor">
<a href="#cross-and-external-validation" class="anchor"></a>Cross and external validation</h2>
<p>Crossvalidation requires the modules to be run using the function <code>RunModels()</code> which runs the model on each fold of the crossvalidating data and predicts the remaining data. It also runs a model and predicts any external validation data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">modCrossvalid &lt;-<span class="st"> </span><span class="kw">RunModels</span>(proc$df, <span class="st">'LogisticRegression'</span>, <span class="kw">list</span>(), <span class="kw">environment</span>())

modelCrossvalid &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">model =</span> modCrossvalid$model, <span class="dt">data =</span> proc$df)

out &lt;-<span class="st"> </span><span class="kw">PrintMap</span>(modelCrossvalid, proc$ras)</code></pre></div>
<p><img src="interactive_cross_validation-1.png" title="plot of chunk interactive_cross_validation" alt="plot of chunk interactive_cross_validation" style="display:block; margin: auto"></p>
<hr>
</div>
<div id="running-workflows-with-list-" class="section level2">
<h2 class="hasAnchor">
<a href="#running-workflows-with-list-" class="anchor"></a>Running workflows with list.</h2>
<p>As mentioned above, workflows using <code>list()</code> are likely to not be easy, but then these aren’t particularly required while developing a package. To run workflows using <code>list</code>, it would be best to use <code>LoadModule</code> as above and then run through the <code>workflow</code> source code interactively.</p>
<hr>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#using-zoon-modules-interactively-">Using zoon modules interactively.</a></li>
      <li><a href="#cross-and-external-validation">Cross and external validation</a></li>
      <li><a href="#running-workflows-with-list-">Running workflows with list.</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Tom August, Tim Lucas, Nick Golding, Greg McInerny.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
